{
  "kind": "build_request",
  "title": "Fix scratch-to-reveal heart + enhance Gift 2 letter + add/update Gift 4 + update Spin Wheel rewards and 5-spin summary",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Fix the existing scratch-to-reveal canvas so scratching visibly erases the overlay and reliably reveals the content underneath on both mouse and touch devices.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-1"
        ],
        "quotes": [
          "Fix Scratch-to-Reveal Feature\nI already added a â€œScratch Meâ€ area but nothing shows.\nPlease fix this so it becomes fully functional."
        ]
      },
      "acceptanceCriteria": [
        "On desktop (mouse) and mobile (touch), dragging over the scratch area clearly removes/erases the overlay at the finger/cursor location.",
        "Scratching works consistently regardless of devicePixelRatio (e.g., normal and retina screens) and after resize/orientation changes.",
        "The scratch overlay is initially visible and does not render as a blank/transparent layer."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Implement a scratch-completion threshold for the scratch-to-reveal feature; once the user scratches enough area, transition to the final reveal state.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-1"
        ],
        "quotes": [
          "When the user scratches enough area:\nA big beating heart â¤ï¸ appears (pulsing animation)\nLots of kisses ğŸ’‹ pop out from the heart and float upward\nShow this message under the heart:\nâ€œLove you cutie ğŸ¥°ğŸ˜˜â€"
        ]
      },
      "acceptanceCriteria": [
        "The app detects when a sufficient percentage of the scratch overlay has been erased (threshold-based).",
        "After the threshold is reached, the overlay no longer blocks the reveal (e.g., it is removed/disabled).",
        "The reveal state shows: (1) a large pulsing heart, (2) many kiss particles that originate near the heart and float upward, and (3) the exact text \"Love you cutie ğŸ¥°ğŸ˜˜\" under the heart."
      ]
    },
    {
      "id": "REQ-3",
      "text": "Update the scratch-to-reveal reveal visuals to match the requested content: a large pulsing heart, kiss pop/floating animation, and the message text \"Love you cutie ğŸ¥°ğŸ˜˜\" (replacing any existing reveal message text).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-1"
        ],
        "quotes": [
          "A big beating heart â¤ï¸ appears (pulsing animation)\nLots of kisses ğŸ’‹ pop out from the heart and float upward\nShow this message under the heart:\nâ€œLove you cutie ğŸ¥°ğŸ˜˜â€"
        ]
      },
      "acceptanceCriteria": [
        "The reveal message shown under the heart is exactly: \"Love you cutie ğŸ¥°ğŸ˜˜\".",
        "The heart is visually large and uses a continuous pulsing/heartbeat animation.",
        "Kiss particles (ğŸ’‹) appear in bursts and float upward over the reveal state."
      ]
    },
    {
      "id": "REQ-4",
      "text": "Gift 2: Ensure the letter content is displayed with a typing animation, and that a click-to-unfold (envelope opening) animation happens before typing begins.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-1"
        ],
        "quotes": [
          "Gift 2 â€“ Letter Typing Animation\nAdd a typing animation for the letter content.\nThe letter should have a click-to-unfold animation before the typing starts."
        ]
      },
      "acceptanceCriteria": [
        "Before opening, Gift 2 shows a clear click-to-unfold interaction for the letter.",
        "Typing does not start until after the unfold/open animation completes.",
        "Once opened, the letter content appears progressively via a typewriter/typing animation (not all at once)."
      ]
    },
    {
      "id": "REQ-5",
      "text": "Gift 4: Ensure there is a Gift 4 screen in the flow after Gift 3 that uses the same scratch-to-reveal effect and reveal content described (pulsing heart, floating kisses, and \"Love you cutie ğŸ¥°ğŸ˜˜\" text).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-1"
        ],
        "quotes": [
          "Add Gift 4 Page\nCreate a new Gift 4 page after Gift 3.\nGift 4 content:\nSame scratch effect mentioned above:\nScratch screen\nBig beating heart â¤ï¸\nKisses popping ğŸ’‹\nâ€œLove you cutie ğŸ¥°ğŸ˜˜â€ text"
        ]
      },
      "acceptanceCriteria": [
        "The navigation/flow order includes Gift 4 directly after Gift 3.",
        "Gift 4 contains a scratch-to-reveal area that uses the same completion/reveal behavior as the fixed scratch feature.",
        "Upon scratch completion, Gift 4 shows the pulsing heart, floating kisses, and the exact text \"Love you cutie ğŸ¥°ğŸ˜˜\"."
      ]
    },
    {
      "id": "REQ-6",
      "text": "Spin the Wheel page: Add the exact pre-spin note text before the wheel/controls, and keep the wheel limited to 5 attempts/spins.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-1"
        ],
        "quotes": [
          "Spin the Wheel Page â€“ Updates\nAdd this note BEFORE spinning:\nâ€œYou will get 5 attempts! Whatever you win from the spinsâ€¦ I will give you ALL of them in real ğŸ˜©ğŸ’•â€"
        ]
      },
      "acceptanceCriteria": [
        "The note is displayed before spinning controls and reads exactly: \"You will get 5 attempts! Whatever you win from the spinsâ€¦ I will give you ALL of them in real ğŸ˜©ğŸ’•\"",
        "The wheel allows exactly 5 spins; attempts decrement by 1 per completed spin.",
        "When attempts reach 0, the UI prevents additional spins."
      ]
    },
    {
      "id": "REQ-7",
      "text": "Spin the Wheel page: Replace the wheel reward list by removing Date Night, Massage, and Movie Night, and using exactly the provided 11 rewards with their exact labels/emojis and messages.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-1"
        ],
        "quotes": [
          "NEW Reward List for the Wheel\nRemove: Date Night, Massage, Movie Night.\nReplace with these rewards:\nğŸ’‹ Kiss Attack\nMessage: â€œGet ready for my unstoppable kiss attack ğŸ˜šğŸ’‹â€\nğŸ¤— Super Hug\nMessage: â€œIâ€™m giving you the BIGGEST hug ever ğŸ˜â¤ï¸â€\nğŸ¥° Your Favourite Food\nMessage: â€œIâ€™ll get you your FAVORITE food, babyy ğŸ˜ğŸ½ï¸â€\nğŸ¶ Song For You\nMessage: â€œIâ€™ll sing or send you a cute romantic song ğŸ¶ğŸ’—â€\nğŸŒ¹ Cute Roses\nMessage: â€œBeautiful roses coming your way, my love ğŸŒ¹ğŸ’•â€\nğŸ« Chocolate Treat\nMessage: â€œYour sweet chocolate treat is on the way ğŸ˜˜ğŸ«â€\nğŸ’ Love Note\nMessage: â€œIâ€™ll write you the cutest love note ever ğŸ’ŒğŸ’â€\nğŸ«¦ Romance ğŸ˜š\nMessage: â€œGet ready for some cute romance time with me ğŸ˜šâ¤ï¸â€ğŸ”¥â€\nğŸ’› Cute Love Letter ğŸ’Œ\nMessage: â€œIâ€™ll give you a handwritten cute love letter ğŸ’›ğŸ’Œâ€\nğŸ Mystery Surprise\nMessage: â€œYou can ask me for ANY mystery gift you want babyyy ğŸâœ¨â€\nâ¤ï¸ Forever Card\nMessage: â€œIâ€™ll make you a â€˜Forever with Youâ€™ card â¤ï¸âœ¨â€"
        ]
      },
      "acceptanceCriteria": [
        "The wheel segments display the updated reward labels and emojis.",
        "After a spin, the reward display shows the selected rewardâ€™s exact message for that reward.",
        "No removed rewards (Date Night, Massage, Movie Night) appear anywhere in the wheel options."
      ]
    },
    {
      "id": "REQ-8",
      "text": "After all 5 spins, show a final reward summary page that lists all 5 rewards the user received and shows the provided sweet message exactly.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-1"
        ],
        "quotes": [
          "After All 5 Spins\nShow a cute final reward summary page with:\nAll 5 rewards the user received\nA sweet message:\nâ€œHey these are your rewards CUTIEPIE ğŸ’\nTake a screenshot and send meâ€¦\nI will give you ALL ğŸ˜˜ğŸ˜˜ğŸ˜˜â€"
        ]
      },
      "acceptanceCriteria": [
        "After the 5th completed spin, the UI transitions to a final summary view/page.",
        "The summary displays all 5 won rewards from that session.",
        "The summary includes the exact text (including line breaks as appropriate): \"Hey these are your rewards CUTIEPIE ğŸ’\\nTake a screenshot and send meâ€¦\\nI will give you ALL ğŸ˜˜ğŸ˜˜ğŸ˜˜\"."
      ]
    },
    {
      "id": "REQ-9",
      "text": "Do not change any other pages, designs, animations, or layout outside of the updates explicitly requested (scratch-to-reveal behavior/visuals, Gift 2 letter behavior, Gift 4 content/placement, and Spin Wheel text/rewards/summary).",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-user-1"
        ],
        "quotes": [
          "Do Not Change Anything Else\nKeep all other pages, designs, animations, and layout exactly the same."
        ]
      },
      "acceptanceCriteria": [
        "All existing screens unrelated to the requested changes remain visually and behaviorally unchanged.",
        "No unrelated copy/text strings are modified.",
        "No backend behavior is introduced or required for these updates."
      ]
    }
  ],
  "constraints": [
    "Frontend immutable paths must not be edited: frontend/src/hooks/useInternetIdentity.ts, frontend/src/hooks/useInternetIdentity.tsx, frontend/src/hooks/useActor.ts, frontend/src/main.tsx, frontend/src/components/ui.",
    "Backend must remain single-actor; only add backend changes if strictly required (these updates should be frontend-only).",
    "Keep all other pages, designs, animations, and layout exactly the same outside the requested updates."
  ],
  "nonGoals": [
    "Adding new authentication methods or third-party integrations.",
    "Adding persistence or saving spin results across sessions/devices.",
    "Redesigning the overall Valentine theme or changing existing layout structure on other screens."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}